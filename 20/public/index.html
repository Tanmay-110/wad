<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Employee Management</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
      background-color: #f4f4f4;
    }
  
    h1, h3 {
      color: #333;
    }
  
    input, button {
      margin: 5px;
      padding: 10px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
  
    input:focus {
      outline: none;
      border-color: #007BFF;
    }
  
    button {
      cursor: pointer;
      background-color: #007BFF;
      color: white;
      border: none;
      transition: background-color 0.3s;
    }
  
    button:hover {
      background-color: #0056b3;
    }
  
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
  
    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: center;
    }
  
    th {
      background-color: #007BFF;
      color: white;
    }
  
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
  
    tr:hover {
      background-color: #f1f1f1;
    }
  
    .action-buttons button {
      margin: 2px;
      padding: 5px 10px;
      font-size: 13px;
    }
  </style>
  
</head>
<body>
  <h1>Employee Management</h1>

  <h3>Add / Update Employee</h3>
  <input type="text" id="id" placeholder="Employee ID (for update)" />
  <input type="text" id="name" placeholder="Name" required />
  <input type="text" id="department" placeholder="Department" required />
  <input type="text" id="designation" placeholder="Designation" required />
  <input type="number" id="salary" placeholder="Salary" required />
  <input type="date" id="joiningDate" required />
  <br>
  <button onclick="addEmployee()">Add Employee</button>
  <button onclick="updateEmployee()">Update Employee</button>

  <h3>All Employees</h3>
  <button onclick="fetchEmployees()">Refresh List</button>

  <table id="employeeTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>Department</th>
        <th>Designation</th>
        <th>Salary</th>
        <th>Joining Date</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const apiUrl = 'http://localhost:5000/api/employees';

    async function addEmployee() {
      const data = getInputData();
      const response = await fetch(apiUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      const result = await response.json();
      alert(result.message || 'Added');
      fetchEmployees();
    }

    async function updateEmployee() {
      const id = document.getElementById('id').value.trim();
      if (!id) return alert("Please provide an employee ID for update.");
      const data = getInputData();
      const response = await fetch(`${apiUrl}/${id}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      const result = await response.json();
      alert(result.message || 'Updated');
      fetchEmployees();
    }

    async function deleteEmployee(id) {
      if (!confirm("Are you sure you want to delete this employee?")) return;
      const response = await fetch(`${apiUrl}/${id}`, {
        method: 'DELETE'
      });
      const result = await response.json();
      alert(result.message || 'Deleted');
      fetchEmployees();
    }

    function getInputData() {
      return {
        name: document.getElementById('name').value,
        department: document.getElementById('department').value,
        designation: document.getElementById('designation').value,
        salary: Number(document.getElementById('salary').value),
        joiningDate: document.getElementById('joiningDate').value
      };
    }

    async function fetchEmployees() {
      const res = await fetch(apiUrl);
      const data = await res.json();
      const tbody = document.querySelector("#employeeTable tbody");
      tbody.innerHTML = '';
      data.forEach(emp => {
        const row = `<tr>
          <td>${emp.name}</td>
          <td>${emp.department}</td>
          <td>${emp.designation}</td>
          <td>${emp.salary}</td>
          <td>${new Date(emp.joiningDate).toLocaleDateString()}</td>
          <td>
            <button onclick="fillForm('${emp._id}', '${emp.name}', '${emp.department}', '${emp.designation}', ${emp.salary}, '${emp.joiningDate}')">Edit</button>
            <button onclick="deleteEmployee('${emp._id}')">Delete</button>
          </td>
        </tr>`;
        tbody.innerHTML += row;
      });
    }

    function fillForm(id, name, dept, desig, salary, date) {
      document.getElementById('id').value = id;
      document.getElementById('name').value = name;
      document.getElementById('department').value = dept;
      document.getElementById('designation').value = desig;
      document.getElementById('salary').value = salary;
      document.getElementById('joiningDate').value = date.split('T')[0];
    }

    // Load on start
    fetchEmployees();
  </script>
</body>
</html>